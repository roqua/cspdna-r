#' Create clean, long dataset from data received from Roqua
#'
#' @param raw A dataframe in pre-specified format (429 variables)
#' @return A clean dataframe that can be used for visualization
#' @import dplyr
#' @importFrom lubridate as_datetime
#' @export
JSON_to_DF <- function(raw) {

  temp <- raw$answers$csp_dna
  temp_values <- raw$answers$csp_dna$values
  
  data <- data.frame(
    # Overall characteristics
    id = temp$id,
    respondent_id = temp$respondent_id,
    csp_dna_non_response = temp$non_response_id,
    csp_dna_open_from = temp$open_from,
    # Time varying characteristics
    # In circle
    csp_dna_fase = temp_values$v_fase,
    csp_dna_1 = temp_values$v_1,
    csp_dna_2 = temp_values$v_2,
    csp_dna_3 = temp_values$v_3,
    csp_dna_4 = temp_values$v_4,
    csp_dna_5 = temp_values$v_5, 
    csp_dna_6 = temp_values$v_6,
    csp_dna_7 = temp_values$v_7,
    csp_dna_8 = temp_values$v_8,
    csp_dna_9 = temp_values$v_9,
    csp_dna_10 = temp_values$v_10, 
    csp_dna_11 = temp_values$v_11,
    csp_dna_12 = temp_values$v_12,
    csp_dna_13 = temp_values$v_13,
    csp_dna_14 = temp_values$v_14,
    csp_dna_15 = temp_values$v_15, 
    csp_dna_16 = temp_values$v_16,
    csp_dna_17 = temp_values$v_17,
    csp_dna_18 = temp_values$v_18,
    csp_dna_19 = temp_values$v_19,
    csp_dna_20 = temp_values$v_20, 
    csp_dna_21 = temp_values$v_21,
    csp_dna_22 = temp_values$v_22,
    csp_dna_23 = temp_values$v_23,
    csp_dna_24 = temp_values$v_24,
    csp_dna_25 = temp_values$v_25, 
    csp_dna_26 = temp_values$v_26,
    csp_dna_27 = temp_values$v_27,
    csp_dna_28 = temp_values$v_28,
    csp_dna_29 = temp_values$v_29,
    csp_dna_30 = temp_values$v_30, 
    csp_dna_31 = temp_values$v_31,
    csp_dna_32 = temp_values$v_32,
    csp_dna_33 = temp_values$v_33,
    csp_dna_34 = temp_values$v_34,
    csp_dna_35 = temp_values$v_35, 
    csp_dna_36 = temp_values$v_36,
    csp_dna_37 = temp_values$v_37,
    csp_dna_38 = temp_values$v_38,
    csp_dna_39 = temp_values$v_39,
    csp_dna_40 = temp_values$v_40, 
    csp_dna_41 = temp_values$v_41,
    csp_dna_42 = temp_values$v_42,
    csp_dna_43 = temp_values$v_43,
    csp_dna_44 = temp_values$v_44,
    csp_dna_45 = temp_values$v_45, 
    csp_dna_46 = temp_values$v_46,
    csp_dna_47 = temp_values$v_47,
    csp_dna_48 = temp_values$v_48,
    csp_dna_49 = temp_values$v_49,
    csp_dna_50 = temp_values$v_50, 
    csp_dna_51 = temp_values$v_51,
    csp_dna_52 = temp_values$v_52,
    csp_dna_53 = temp_values$v_53,
    csp_dna_54 = temp_values$v_54,
    # GAP HERE
    csp_dna_58 = temp_values$v_58, 
    csp_dna_59 = temp_values$v_59,
    csp_dna_60 = temp_values$v_60,
    csp_dna_61 = temp_values$v_61,
    csp_dna_62 = temp_values$v_62,
    csp_dna_63 = temp_values$v_63, 
    csp_dna_64 = temp_values$v_64,
    csp_dna_65 = temp_values$v_65,
    csp_dna_66 = temp_values$v_66,
    csp_dna_67 = temp_values$v_67,
    csp_dna_68 = temp_values$v_68, 
    csp_dna_69 = temp_values$v_69,
    csp_dna_70 = temp_values$v_70,
    csp_dna_71 = temp_values$v_71,
    csp_dna_72 = temp_values$v_72,
    csp_dna_73 = temp_values$v_73, 
    csp_dna_74 = temp_values$v_74,
    csp_dna_75 = temp_values$v_75,
    csp_dna_76 = temp_values$v_76,
    csp_dna_77 = temp_values$v_77,
    csp_dna_78 = temp_values$v_78,
    # Grid vars
    csp_dna_58a_a1 = temp_values$v_58a_a1, 
    csp_dna_58a_a2 = temp_values$v_58a_a2, 
    csp_dna_58a_a3 = temp_values$v_58a_a3, 
    csp_dna_58a_a4 = temp_values$v_58a_a4, 
    csp_dna_58a_a5 = temp_values$v_58a_a5, 
    csp_dna_58a_a6 = temp_values$v_58a_a6, 
    csp_dna_59a_a1 = temp_values$v_59a_a1, 
    csp_dna_59a_a2 = temp_values$v_59a_a2, 
    csp_dna_59a_a3 = temp_values$v_59a_a3, 
    csp_dna_59a_a4 = temp_values$v_59a_a4, 
    csp_dna_59a_a5 = temp_values$v_59a_a5, 
    csp_dna_59a_a6 = temp_values$v_59a_a6, 
    csp_dna_60a_a1 = temp_values$v_60a_a1, 
    csp_dna_60a_a2 = temp_values$v_60a_a2, 
    csp_dna_60a_a3 = temp_values$v_60a_a3, 
    csp_dna_60a_a4 = temp_values$v_60a_a4, 
    csp_dna_60a_a5 = temp_values$v_60a_a5, 
    csp_dna_60a_a6 = temp_values$v_60a_a6, 
    csp_dna_61a_a1 = temp_values$v_61a_a1, 
    csp_dna_61a_a2 = temp_values$v_61a_a2, 
    csp_dna_61a_a3 = temp_values$v_61a_a3, 
    csp_dna_61a_a4 = temp_values$v_61a_a4, 
    csp_dna_61a_a5 = temp_values$v_61a_a5, 
    csp_dna_61a_a6 = temp_values$v_61a_a6, 
    csp_dna_62a_a1 = temp_values$v_62a_a1, 
    csp_dna_62a_a2 = temp_values$v_62a_a2, 
    csp_dna_62a_a3 = temp_values$v_62a_a3, 
    csp_dna_62a_a4 = temp_values$v_62a_a4, 
    csp_dna_62a_a5 = temp_values$v_62a_a5, 
    csp_dna_62a_a6 = temp_values$v_62a_a6, 
    csp_dna_63a_a1 = temp_values$v_63a_a1, 
    csp_dna_63a_a2 = temp_values$v_63a_a2, 
    csp_dna_63a_a3 = temp_values$v_63a_a3, 
    csp_dna_63a_a4 = temp_values$v_63a_a4, 
    csp_dna_63a_a5 = temp_values$v_63a_a5, 
    csp_dna_63a_a6 = temp_values$v_63a_a6, 
    csp_dna_63a_a7 = temp_values$v_63a_a7, 
    csp_dna_63a_a8 = temp_values$v_63a_a8, 
    csp_dna_63a_a9 = temp_values$v_63a_a9, 
    csp_dna_63a_a10 = temp_values$v_63a_a10, 
    csp_dna_63a_a11 = temp_values$v_63a_a11,
    csp_dna_63a_a12 = temp_values$v_63a_a12, 
    csp_dna_63a_a13 = temp_values$v_63a_a13,
    csp_dna_63a_a14 = temp_values$v_63a_a14, 
    csp_dna_64a_a1 = temp_values$v_64a_a1, 
    csp_dna_64a_a2 = temp_values$v_64a_a2, 
    csp_dna_64a_a3 = temp_values$v_64a_a3, 
    csp_dna_64a_a4 = temp_values$v_64a_a4, 
    csp_dna_64a_a5 = temp_values$v_64a_a5, 
    csp_dna_64a_a6 = temp_values$v_64a_a6, 
    csp_dna_64a_a7 = temp_values$v_64a_a7, 
    csp_dna_64a_a8 = temp_values$v_64a_a8, 
    csp_dna_64a_a9 = temp_values$v_64a_a9, 
    csp_dna_64a_a10 = temp_values$v_64a_a10, 
    csp_dna_64a_a11 = temp_values$v_64a_a11,
    csp_dna_64a_a12 = temp_values$v_64a_a12, 
    csp_dna_64a_a13 = temp_values$v_64a_a13,
    csp_dna_64a_a14 = temp_values$v_64a_a14, 
    csp_dna_65a_a1 = temp_values$v_65a_a1,
    csp_dna_65a_a2 = temp_values$v_65a_a2, 
    csp_dna_65a_a3 = temp_values$v_65a_a3,
    csp_dna_65a_a4 = temp_values$v_65a_a4, 
    csp_dna_65a_a5 = temp_values$v_65a_a5,
    csp_dna_65a_a6 = temp_values$v_65a_a6, 
    csp_dna_65a_a7 = temp_values$v_65a_a7,
    csp_dna_65a_a8 = temp_values$v_65a_a8, 
    csp_dna_65a_a9 = temp_values$v_65a_a9,
    csp_dna_65a_a10 = temp_values$v_65a_a10, 
    csp_dna_65a_a11 = temp_values$v_65a_a11,
    csp_dna_65a_a12 = temp_values$v_65a_a12, 
    csp_dna_65a_a13 = temp_values$v_65a_a13,
    csp_dna_65a_a14 = temp_values$v_65a_a14, 
    csp_dna_66a_a1 = temp_values$v_66a_a1,
    csp_dna_66a_a2 = temp_values$v_66a_a2, 
    csp_dna_66a_a3 = temp_values$v_66a_a3,
    csp_dna_66a_a4 = temp_values$v_66a_a4, 
    csp_dna_67a_a1 = temp_values$v_67a_a1,
    csp_dna_67a_a2 = temp_values$v_67a_a2, 
    csp_dna_67a_a3 = temp_values$v_67a_a3,
    csp_dna_67a_a4 = temp_values$v_67a_a4, 
    csp_dna_67a_a5 = temp_values$v_67a_a5,
    csp_dna_67a_a6 = temp_values$v_67a_a6, 
    csp_dna_67a_a7 = temp_values$v_67a_a7,
    csp_dna_67a_a8 = temp_values$v_67a_a8, 
    csp_dna_67a_a9 = temp_values$v_67a_a9,
    csp_dna_67a_a10 = temp_values$v_67a_a10, 
    csp_dna_67a_a11 = temp_values$v_67a_a11,
    csp_dna_67a_a12 = temp_values$v_67a_a12, 
    csp_dna_67a_a13 = temp_values$v_67a_a13,
    csp_dna_67a_a14 = temp_values$v_67a_a14, 
    csp_dna_68a_a1 = temp_values$v_68a_a1,
    csp_dna_68a_a2 = temp_values$v_68a_a2, 
    csp_dna_68a_a3 = temp_values$v_68a_a3,
    csp_dna_68a_a4 = temp_values$v_68a_a4, 
    csp_dna_68a_a5 = temp_values$v_68a_a5,
    csp_dna_68a_a6 = temp_values$v_68a_a6, 
    csp_dna_68a_a7 = temp_values$v_68a_a7,
    csp_dna_68a_a8 = temp_values$v_68a_a8, 
    csp_dna_68a_a9 = temp_values$v_68a_a9,
    csp_dna_68a_a10 = temp_values$v_68a_a10, 
    csp_dna_68a_a11 = temp_values$v_68a_a11,
    csp_dna_68a_a12 = temp_values$v_68a_a12, 
    csp_dna_68a_a13 = temp_values$v_68a_a13,
    csp_dna_68a_a14 = temp_values$v_68a_a14, 
    csp_dna_69a_a1 = temp_values$v_69a_a1,
    csp_dna_69a_a2 = temp_values$v_69a_a2, 
    csp_dna_69a_a3 = temp_values$v_69a_a3,
    csp_dna_69a_a4 = temp_values$v_69a_a4, 
    csp_dna_69a_a5 = temp_values$v_69a_a5,
    csp_dna_69a_a6 = temp_values$v_69a_a6, 
    csp_dna_69a_a7 = temp_values$v_69a_a7,
    csp_dna_69a_a8 = temp_values$v_69a_a8, 
    csp_dna_69a_a9 = temp_values$v_69a_a9,
    csp_dna_69a_a10 = temp_values$v_69a_a10, 
    csp_dna_69a_a11 = temp_values$v_69a_a11,
    csp_dna_69a_a12 = temp_values$v_69a_a12, 
    csp_dna_69a_a13 = temp_values$v_69a_a13,
    csp_dna_69a_a14 = temp_values$v_69a_a14, 
    csp_dna_70a_a1 = temp_values$v_70a_a1,
    csp_dna_70a_a2 = temp_values$v_70a_a2, 
    csp_dna_70a_a3 = temp_values$v_70a_a3,
    csp_dna_70a_a4 = temp_values$v_70a_a4, 
    csp_dna_70a_a5 = temp_values$v_70a_a5,
    csp_dna_70a_a6 = temp_values$v_70a_a6, 
    csp_dna_70a_a7 = temp_values$v_70a_a7,
    csp_dna_70a_a8 = temp_values$v_70a_a8, 
    csp_dna_70a_a9 = temp_values$v_70a_a9,
    csp_dna_70a_a10 = temp_values$v_70a_a10, 
    csp_dna_70a_a11 = temp_values$v_70a_a11, 
    csp_dna_70a_a12 = temp_values$v_70a_a12, 
    csp_dna_71a_a1 = temp_values$v_71a_a1,
    csp_dna_71a_a2 = temp_values$v_71a_a2, 
    csp_dna_71a_a3 = temp_values$v_71a_a3,
    csp_dna_71a_a4 = temp_values$v_71a_a4, 
    csp_dna_71a_a5 = temp_values$v_71a_a5,
    csp_dna_71a_a6 = temp_values$v_71a_a6, 
    csp_dna_72a_a1 = temp_values$v_72a_a1,
    csp_dna_72a_a2 = temp_values$v_72a_a2, 
    csp_dna_72a_a3 = temp_values$v_72a_a3,
    csp_dna_72a_a4 = temp_values$v_72a_a4, 
    csp_dna_72a_a5 = temp_values$v_72a_a5,
    csp_dna_72a_a6 = temp_values$v_72a_a6, 
    csp_dna_72a_a7 = temp_values$v_72a_a7,
    csp_dna_72a_a8 = temp_values$v_72a_a8, 
    csp_dna_73a_a1 = temp_values$v_73a_a1,
    csp_dna_73a_a2 = temp_values$v_73a_a2, 
    csp_dna_73a_a3 = temp_values$v_73a_a3,
    csp_dna_73a_a4 = temp_values$v_73a_a4, 
    csp_dna_73a_a5 = temp_values$v_73a_a5,
    csp_dna_73a_a6 = temp_values$v_73a_a6, 
    csp_dna_73a_a7 = temp_values$v_73a_a7,
    csp_dna_73a_a8 = temp_values$v_73a_a8, 
    csp_dna_74a_a1 = temp_values$v_74a_a1,
    csp_dna_74a_a2 = temp_values$v_74a_a2, 
    csp_dna_74a_a3 = temp_values$v_74a_a3,
    csp_dna_74a_a4 = temp_values$v_74a_a4, 
    csp_dna_75a_a1 = temp_values$v_75a_a1,
    csp_dna_75a_a2 = temp_values$v_75a_a2, 
    csp_dna_75a_a3 = temp_values$v_75a_a3,
    csp_dna_75a_a4 = temp_values$v_75a_a4, 
    csp_dna_76a_a1 = temp_values$v_76a_a1,
    csp_dna_76a_a2 = temp_values$v_76a_a2, 
    csp_dna_76a_a3 = temp_values$v_76a_a3,
    csp_dna_76a_a4 = temp_values$v_76a_a4, 
    csp_dna_76a_a5 = temp_values$v_76a_a5,
    csp_dna_76a_a6 = temp_values$v_76a_a6, 
    csp_dna_76a_a7 = temp_values$v_76a_a7,
    csp_dna_76a_a8 = temp_values$v_76a_a8, 
    csp_dna_76a_a9 = temp_values$v_76a_a9,
    csp_dna_76a_a10 = temp_values$v_76a_a10, 
    csp_dna_76a_a11 = temp_values$v_76a_a11,
    csp_dna_76a_a12 = temp_values$v_76a_a12, 
    csp_dna_76a_a13 = temp_values$v_76a_a13,
    csp_dna_76a_a14 = temp_values$v_76a_a14, 
    csp_dna_76a_a15 = temp_values$v_76a_a15,
    csp_dna_76a_a16 = temp_values$v_76a_a16,
    # Other variables (labels)
    csp_dna_55a = temp_values$v_55a,
    csp_dna_55_a0 = temp_values$v_55_a0,
    csp_dna_56a  = temp_values$v_56a,
    csp_dna_57a = temp_values$v_57a,
    csp_dna_77a = temp_values$v_77a,
    csp_dna_78a = temp_values$v_78a,
    # Sleep variables
    csp_dna_79 = temp_values$v_79,
    csp_dna_79a = temp_values$v_79a,
    csp_dna_79b = temp_values$v_79b
  )
  
  return(data)
}



